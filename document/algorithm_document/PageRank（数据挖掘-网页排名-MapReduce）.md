#PageRank(网页排名)
网页排名，或网页级别，根据网页之间相互的超链接计算，通过网页间的超链接关系确定一个页面的等级

计算每一个网页的PageRank值，然后根据这个值的大小对网页的重要性进行排序

##PageRank举例

###1.什么是PageRank
模拟一个悠闲的上网者，上网者首先随机选择一个网页打开，然后在这个网页上呆了几分钟后，跳转到该网页所指向的链接，这样无所事事，漫无目的的在网页上跳来跳去，PageRank就是估计这个悠闲的上网者在各个网页上的概率

###2.简单的PageRank模型
互联网中的网页可以看成一个有向图，网页是节点，如果网页A有链接到网页B，则存在一条有向边A->B。图PageRank1：

那么悠闲的上网者将会各以1/3的概率跳转到B、C、D，这里的3表示A有3条出链，如果一个网页有k条出链，那么跳转任意一个出链上的概率是1/k，同理D到B、C的概率各为1/2，而B到C的概率为0

如果网页j有k个出链，那么对于每一个出链指向的网页i，有M[i][j] = 1/k,而其他网页的M[i][j] = 0，可以将转移的概率转变为矩阵M
	
		A			B			C		D
	A	0			1/2			1		0
	B	1/3			0			0		1/2
	C	1/3			0			0		1/2
	D	1/3			1/2			0		0

例如：B到A的概率1/2， C到A的概率1

开始计算时，假设上网者在每一个网页的概率都是相等的，即1/n,设定列向量矩阵V0
	
	1/4
	1/4
	1/4
	1/4

用V0乘M，得到第一步之后上网者的概率分布矩阵V1
	
	0			1/2			1		0					1/4					9/24
	1/3			0			0		1/2					1/4					5/24
	1/3			0			0		1/2			X		1/4			=		5/24
	1/3			1/2			0		0					1/4					5/24

不断迭代，得到最终的分布概率矩阵V
	
	3/9
	2/9
	2/9
	2/9

###3.终止点问题
上述计算最终分布概率矩阵的过程为马尔科夫链，要满足收敛性，需要一个条件：图是强连通的，即从任意网页可以到达其他任意网页，如图PageRank2，网页C没有指向网页A的出链，导致迭代计算所有的概率都为0

###4.陷阱问题
如图PageRank3，网页C存在指向自己的出链，迭代计算C的概率为1，其他为0

###5.解决终止点问题与陷阱问题
上面过程，我们忽略了一个问题，那就是上网者是一个悠闲的上网者，而不是一个愚蠢的上网者，我们的上网者是聪明而悠闲，他悠闲，漫无目的，总是随机的选择网页，他聪明，在走到一个终结网页或者一个陷阱网页（比如两个示例中的C），不会傻傻的干着急，他会在浏览器的地址随机输入一个地址，当然这个地址可能又是原来的网页，但这里给了他一个逃离的机会，让他离开这万丈深渊。模拟聪明而又悠闲的上网者，对算法进行改进，每一步，上网者可能都不想看当前网页了，不看当前网页也就不会点击上面的连接，而上悄悄地在地址栏输入另外一个地址，而在地址栏输入而跳转到各个网页的概率是1/n

假设上网者每一步查看当前网页的概率为a，那么他从浏览器地址栏跳转的概率为(1-a)，于是原来的迭代公式转化为：V=aMV + (1-a)e

其中a：每一步查看当前网页的概率；M：网页状态转移概率矩阵；V：迭代计算的结果；e：初始概率矩阵

###6.MapReduce计算PageRank
上面的演算过程，采用矩阵相乘，不断迭代，直到迭代前后概率分布向量的值变化不大，一般迭代到30次以上就收敛了。真的的web结构的转移矩阵非常大，目前的网页数量已经超过100亿，转移矩阵是100亿*100亿的矩阵，直接按矩阵乘法的计算方法不可行，需要借助Map-Reduce的计算方式来解决

1.Map阶段

Map操作的每一行，对所有出链发射当前网页概率值的1/k，k是当前网页的出链数，比如对第一行输出<B，1/3 X 1/4>,<C，1/3 X 1/4>,<D，1/3 X 1/4>;

2.Reduce阶段

Reduce操作收集网页id相同的值，累加并按权重计算，pj=a*(p1+p2+…Pm)+(1-a)*1/n，其中m是指向网页j的网页j数，n所有网页数。

思路就是这么简单，但是实践的时候，怎样在Map阶段知道当前行网页的概率值，需要一个单独的文件专门保存上一轮的概率分布值，先进行一次排序，让出链行与概率值按网页id出现在同一Mapper里面

如图PageRank_MapReduce,这样进行一次迭代相当于需要两次MapReduce，但第一次的MapReduce只是简单的排序，不需要任何操作

用python调用Hadoop的Streaming,即可实现MapReduce进行PageRank计算
